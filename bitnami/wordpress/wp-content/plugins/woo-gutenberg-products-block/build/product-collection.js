(()=>{var e,t={3415:(e,t,o)=>{"use strict";o.r(t);const r=window.wp.blocks,n=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"woocommerce/product-collection","version":"1.0.0","title":"Product Collection (Beta)","description":"Display a collection of products from your store.","category":"woocommerce","keywords":["WooCommerce","Products (Beta)"],"textdomain":"woo-gutenberg-products-block","attributes":{"queryId":{"type":"number"},"query":{"type":"object"},"tagName":{"type":"string"},"displayLayout":{"type":"object"},"convertedFromProducts":{"type":"boolean","default":false}},"providesContext":{"queryId":"queryId","query":"query","displayLayout":"displayLayout"},"supports":{"align":["wide","full"],"anchor":true,"html":false,"__experimentalLayout":true}}');var c=o(9307);const l=window.wp.blockEditor;var a=o(4333);let s=function(e){return e.SINGLE="single",e.THUMBNAIL="thumbnail",e}({});const u=window.wp.components;var i=o(229);function m(e,{blockDescription:t,blockIcon:o,blockTitle:n,variationName:c}){(0,r.registerBlockVariation)(e,{description:t,name:c,title:n,isActive:e=>e.__woocommerceNamespace===c,icon:{src:o},attributes:{__woocommerceNamespace:c},scope:["block","inserter"]})}var d=o(5736),p=o(1984);const b=(0,d.__)("Product Title","woo-gutenberg-products-block"),g=((0,c.createElement)(p.Z,{icon:i.Z,className:"wc-block-editor-components-block-icon"}),(0,d.__)("Display the title of a product.","woo-gutenberg-products-block")),_="woocommerce/product-collection/product-title",w=window.wp.hooks;var h=o(7286),y=o(6755);o(4662);const k=({text:e,title:t=(0,d.__)("Feedback?","woo-gutenberg-products-block"),url:o="https://ideas.woocommerce.com/forums/133476-woocommerce?category_id=384565"})=>{const[r,n]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{n(!0)}),[]),(0,c.createElement)(c.Fragment,null,r&&(0,c.createElement)("div",{className:"wc-block-feedback-prompt"},(0,c.createElement)(p.Z,{icon:h.Z}),(0,c.createElement)("h2",{className:"wc-block-feedback-prompt__title"},t),(0,c.createElement)("p",{className:"wc-block-feedback-prompt__text"},e),(0,c.createElement)("a",{href:o,className:"wc-block-feedback-prompt__link",rel:"noreferrer noopener",target:"_blank"},(0,d.__)("Give us your feedback.","woo-gutenberg-products-block"),(0,c.createElement)(p.Z,{icon:y.Z,size:16}))))},E=()=>(0,c.createElement)(k,{text:(0,d.__)("Thanks for trying out the Product Collection block! Help us make it better by sharing your feedback.","woo-gutenberg-products-block"),title:(0,d.__)("Share your feedback!","woo-gutenberg-products-block"),url:"https://airtable.com/shrqsMSDPvAKoY99u"}),f=window.wp.data,v=window.wc.wcSettings,S="wc-blocks_upgraded-products-to-product-collection",C=()=>({status:"notseen",time:Date.now(),displayCount:0}),x=e=>"woocommerce/product-collection"===e.name&&e.attributes.convertedFromProducts,N=(e,t)=>{let o=[];return e.forEach((e=>{t(e)&&(o=[...o,e.clientId]),o=[...o,...N(e.innerBlocks,t)]})),o},I=(0,v.getSettingWithCoercion)("postTemplateHasSupportForGridView",!1,(e=>"boolean"==typeof e)),P=()=>{const e=window.localStorage.getItem(S);return e?JSON.parse(e):C()},T=e=>{window.localStorage.setItem(S,JSON.stringify(e))};const A=e=>"flex"===e?"grid":"list"===e?"default":"grid",B=e=>{const{type:t,columns:o}=e;return{type:A(t),columnCount:o}},O=(e,t)=>{const o=e.map((e=>{const{name:o,attributes:n}=e,c=O(e.innerBlocks);return(({name:e})=>"woocommerce/product-template"===e)(e)?((e,t,o)=>(0,r.createBlock)("core/post-template",{className:"products-block-post-template",layout:I?B(o):void 0,__woocommerceNamespace:"woocommerce/product-query/product-template",...e.attributes},t))(e,c,t):(({name:e,attributes:t})=>"core/post-title"===e&&"woocommerce/product-collection/product-title"===t.__woocommerceNamespace)(e)?((e,t)=>{const{__woocommerceNamespace:o,...n}=e.attributes;return(0,r.createBlock)("core/post-title",{__woocommerceNamespace:"woocommerce/product-collection/product-title",...n},t)})(e,c):(({name:e,attributes:t})=>"core/post-excerpt"===e&&"woocommerce/product-collection/product-summary"===t.__woocommerceNamespace)(e)?((e,t)=>{const{__woocommerceNamespace:o,...n}=e.attributes;return(0,r.createBlock)("core/post-excerpt",{__woocommerceNamespace:"woocommerce/product-collection/product-summary",...n},t)})(e,c):(0,r.createBlock)(o,n,c)}));return o},L=e=>{const t=(0,f.select)("core/block-editor").getBlock(e),o=((e,t)=>{const o=(0,f.select)("core/block-editor").getBlockRootClientId(e)||void 0;return(0,f.select)("core/block-editor").canInsertBlockType(t,o)})(e,"core/query");if(t&&o){const{attributes:o={},innerBlocks:n=[]}=t,{displayLayout:c,...l}=o,a=(e=>{const{query:t,...o}=e,{woocommerceAttributes:r,woocommerceStockStatus:n,woocommerceOnSale:c,woocommerceHandPickedProducts:l,taxQuery:a,parents:s,isProductCollectionBlock:u,...i}=t,m={...i};return l&&(m.include=l),c&&(m.__woocommerceOnSale=c),a&&(m.taxQuery=a),{...o,namespace:"woocommerce/product-query",query:{__woocommerceAttributes:r||[],__woocommerceStockStatus:n||[],...m}}})(I?l:o),s=O(n,c),u=(0,r.createBlock)("core/query",a,s);return(0,f.dispatch)("core/block-editor").replaceBlock(e,u),!0}return!1},R=()=>{var e;T({status:"reverted",time:Date.now()}),(e=(0,f.select)("core/block-editor").getBlocks(),N(e,x)).map(L)};function q(e,t){const{query:o}=e.attributes;e.setAttributes({query:{...o,...t}})}function M(){const e=(0,f.select)("core/edit-site"),t=null==e?void 0:e.getEditedPostId();return!!t&&["woocommerce/woocommerce//archive-product","woocommerce/woocommerce//taxonomy-product_cat","woocommerce/woocommerce//taxonomy-product_tag","woocommerce/woocommerce//taxonomy-product_attribute","woocommerce/woocommerce//product-search-results"].includes(t)}let D=function(e){return e.GRID="flex",e.STACK="list",e}({});const F=(0,v.getSetting)("stockStatusOptions",[]),j=(0,v.getSetting)("hideOutOfStockItems",!1),$=()=>j?Object.keys(function(e,t){const{[t]:o,...r}=e;return r}(F,"outofstock")):Object.keys(F),G={perPage:9,pages:0,offset:0,postType:"product",order:"asc",orderBy:"title",author:"",search:"",exclude:[],sticky:"",inherit:null,taxQuery:{},parents:[],isProductCollectionBlock:!0,woocommerceOnSale:!1,woocommerceStockStatus:$(),woocommerceAttributes:[],woocommerceHandPickedProducts:[]},V={query:G,tagName:"div",displayLayout:{type:D.GRID,columns:3}},H=e=>({...e,orderBy:G.orderBy,order:G.order,inherit:M()}),Z=()=>V.displayLayout,Q={woocommerceOnSale:G.woocommerceOnSale,woocommerceStockStatus:$(),woocommerceAttributes:[],taxQuery:G.taxQuery,woocommerceHandPickedProducts:[]},z=(0,c.createInterpolateElement)((0,d.__)("Products (Beta) block was upgraded to <strongText />, an updated version with new features and simplified settings.","woo-gutenberg-products-block"),{strongText:(0,c.createElement)("strong",null,(0,d.__)("Product Collection","woo-gutenberg-products-block"))}),J=(0,d.__)("Revert to Products (Beta)","woo-gutenberg-products-block"),K=({revertMigration:e})=>{const[t,o]=((e,t)=>{const[o,r]=(0,c.useState)((()=>{const o=window.localStorage.getItem(e);if(o)try{return JSON.parse(o)}catch{console.error(`Value for key '${e}' could not be retrieved from localStorage because it can't be parsed.`)}return t}));return(0,c.useEffect)((()=>{try{window.localStorage.setItem(e,JSON.stringify(o))}catch{console.error(`Value for key '${e}' could not be saved in localStorage because it can't be converted into a string.`)}}),[e,o]),[o,r]})(S,C()),r=(0,c.useRef)(!0),{status:n}=t;return(0,c.useEffect)((()=>()=>{r.current&&((()=>{const e=P(),t="number"==typeof e.displayCount?e.displayCount+1:0;T({...e,displayCount:t})})(),r.current=!1)}),[r]),"notseen"===n?(0,c.createElement)(u.Notice,{onRemove:()=>{o({status:"seen",time:Date.now()})}},(0,c.createElement)(c.Fragment,null,z," "),(0,c.createElement)("br",null),(0,c.createElement)("br",null),(0,c.createElement)(u.Button,{variant:"link",onClick:()=>{e()}},J)):null},U=e=>{const{type:t,columns:o}=e.displayLayout,r="flex"===t,n=Z();return r?(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Columns","woo-gutenberg-products-block"),hasValue:()=>(null==n?void 0:n.columns)!==o||(null==n?void 0:n.type)!==t,isShownByDefault:!0,onDeselect:()=>{e.setAttributes({displayLayout:n})}},(0,c.createElement)(u.RangeControl,{label:(0,d.__)("Columns","woo-gutenberg-products-block"),value:o,onChange:t=>e.setAttributes({displayLayout:{...e.displayLayout,columns:t}}),min:2,max:Math.max(6,o)})):null},W=e=>!(e=>null===e)(e)&&e instanceof Object&&e.constructor===Object;function Y(e,t){return W(e)&&t in e}const X=(0,d.__)("Inherit query from template","woo-gutenberg-products-block"),ee=({setQueryAttribute:e,query:t})=>{const o=null==t?void 0:t.inherit,r=(0,f.select)("core/edit-site"),n=function(e,t){const o=(0,c.useRef)();return(0,c.useEffect)((()=>{o.current===e||t&&!t(e,o.current)||(o.current=e)}),[e,t]),o.current}(t,(e=>!1===(null==e?void 0:e.inherit))),l=(0,c.useMemo)((()=>M()),[]);return(e=>{if(W(e)){const t=e.getEditedPostType();return"wp_template"===t||"wp_template_part"===t}return!1})(r)?(0,c.createElement)(u.__experimentalToolsPanelItem,{label:X,hasValue:()=>o!==l,isShownByDefault:!0,onDeselect:()=>{e({inherit:l})}},(0,c.createElement)(u.ToggleControl,{className:"wc-block-product-collection__inherit-query-control",label:X,help:(0,d.__)("Toggle to use the global query context that is set with the current template, such as an archive or search. Disable to customize the settings independently.","woo-gutenberg-products-block"),checked:!!o,onChange:t=>{e(t?{...G,inherit:t}:{...G,...n,inherit:t})}})):null},te=[{label:(0,d.__)("A → Z","woo-gutenberg-products-block"),value:"title/asc"},{label:(0,d.__)("Z → A","woo-gutenberg-products-block"),value:"title/desc"},{label:(0,d.__)("Newest to oldest","woo-gutenberg-products-block"),value:"date/desc"},{label:(0,d.__)("Oldest to newest","woo-gutenberg-products-block"),value:"date/asc"},{value:"popularity/desc",label:(0,d.__)("Best Selling","woo-gutenberg-products-block")},{value:"rating/desc",label:(0,d.__)("Top Rated","woo-gutenberg-products-block")}],oe=e=>{const{query:t,setQueryAttribute:o}=e,{order:r,orderBy:n}=t,l=H(t);return(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Order by","woo-gutenberg-products-block"),hasValue:()=>r!==(null==l?void 0:l.order)||n!==(null==l?void 0:l.orderBy),isShownByDefault:!0,onDeselect:()=>{o(l)}},(0,c.createElement)(u.SelectControl,{value:`${n}/${r}`,options:te,label:(0,d.__)("Order by","woo-gutenberg-products-block"),onChange:e=>{const[t,r]=e.split("/");o({order:r,orderBy:t})}}))},re=e=>{const{query:t,setQueryAttribute:o}=e;return(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("On Sale","woo-gutenberg-products-block"),hasValue:()=>!0===t.woocommerceOnSale,isShownByDefault:!0,onDeselect:()=>{o({woocommerceOnSale:!1})}},(0,c.createElement)(u.ToggleControl,{label:(0,d.__)("Show only products on sale","woo-gutenberg-products-block"),checked:t.woocommerceOnSale||!1,onChange:e=>{o({woocommerceOnSale:e})}}))};var ne=o(2991),ce=o.n(ne);function le(e){var t;const o="string"==typeof e?e:e.value;return null===(t=Object.entries(F).find((([,e])=>e===o)))||void 0===t?void 0:t[0]}const ae=e=>{var t;const{query:o,setQueryAttribute:r}=e;return(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Stock status","woo-gutenberg-products-block"),hasValue:()=>!ce()(o.woocommerceStockStatus,$()),onDeselect:()=>{r({woocommerceStockStatus:$()})},isShownByDefault:!0},(0,c.createElement)(u.FormTokenField,{label:(0,d.__)("Stock status","woo-gutenberg-products-block"),onChange:e=>{const t=e.map(le).filter(Boolean);r({woocommerceStockStatus:t})},suggestions:Object.values(F),validateInput:e=>Object.values(F).includes(e),value:(null==o||null===(t=o.woocommerceStockStatus)||void 0===t?void 0:t.map((e=>F[e])))||[],__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1}))},se=e=>{const{query:t,setQueryAttribute:o}=e,[r,n]=(0,c.useState)(t.search),l=(0,a.useDebounce)((()=>{t.search!==r&&o({search:r})}),250);return(0,c.useEffect)((()=>(l(),l.cancel)),[r,l]),(0,c.createElement)(u.__experimentalToolsPanelItem,{hasValue:()=>!!r,label:(0,d.__)("Keyword","woo-gutenberg-products-block"),onDeselect:()=>n(""),resetAllFilter:()=>n("")},(0,c.createElement)(u.TextControl,{label:(0,d.__)("Keyword","woo-gutenberg-products-block"),value:r,onChange:n}))};var ue=o(4184),ie=o.n(ue);function me(e,t,o){const r=new Set(t.map((e=>e[o])));return e.filter((e=>!r.has(e[o])))}const de=window.wp.htmlEntities,pe={clear:(0,d.__)("Clear all selected items","woo-gutenberg-products-block"),noItems:(0,d.__)("No items found.","woo-gutenberg-products-block"),
/* Translators: %s search term */
noResults:(0,d.__)("No results for %s","woo-gutenberg-products-block"),search:(0,d.__)("Search for items","woo-gutenberg-products-block"),selected:e=>(0,d.sprintf)(/* translators: Number of items selected from list. */
(0,d._n)("%d item selected","%d items selected",e,"woo-gutenberg-products-block"),e),updated:(0,d.__)("Search results updated.","woo-gutenberg-products-block")},be=(e,t=e)=>{const o=e.reduce(((e,t)=>{const o=t.parent||0;return e[o]||(e[o]=[]),e[o].push(t),e}),{}),r=("id",t.reduce(((e,t)=>(e[String(t.id)]=t,e)),{}));const n=["0"],c=(e={})=>e.parent?[...c(r[e.parent]),e.name]:e.name?[e.name]:[],l=e=>e.map((e=>{const t=o[e.id];return n.push(""+e.id),{...e,breadcrumbs:c(r[e.parent]),children:t&&t.length?l(t):[]}})),a=l(o[0]||[]);return Object.entries(o).forEach((([e,t])=>{n.includes(e)||a.push(...l(t||[]))})),a},ge=(e,t)=>{if(!t)return e;const o=new RegExp(`(${t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")})`,"ig");return e.split(o).map(((e,t)=>o.test(e)?(0,c.createElement)("strong",{key:t},e):(0,c.createElement)(c.Fragment,{key:t},e)))},_e=({label:e})=>(0,c.createElement)("span",{className:"woocommerce-search-list__item-count"},e),we=e=>{const{item:t,search:o}=e,r=t.breadcrumbs&&t.breadcrumbs.length;return(0,c.createElement)("span",{className:"woocommerce-search-list__item-label"},r?(0,c.createElement)("span",{className:"woocommerce-search-list__item-prefix"},1===(n=t.breadcrumbs).length?n.slice(0,1).toString():2===n.length?n.slice(0,1).toString()+" › "+n.slice(-1).toString():n.slice(0,1).toString()+" … "+n.slice(-1).toString()):null,(0,c.createElement)("span",{className:"woocommerce-search-list__item-name"},ge((0,de.decodeEntities)(t.name),o)));var n},he=({countLabel:e,className:t,depth:o=0,controlId:r="",item:n,isSelected:l,isSingle:a,onSelect:s,search:i="",selected:m,useExpandedPanelId:d,...p})=>{var b,g;const[_,w]=d,h=null!=e&&void 0!==n.count&&null!==n.count,y=!(null===(b=n.breadcrumbs)||void 0===b||!b.length),k=!(null===(g=n.children)||void 0===g||!g.length),E=_===n.id,f=ie()(["woocommerce-search-list__item",`depth-${o}`,t],{"has-breadcrumbs":y,"has-children":k,"has-count":h,"is-expanded":E,"is-radio-button":a}),v=p.name||`search-list-item-${r}`,S=`${v}-${n.id}`,C=(0,c.useCallback)((()=>{w(E?-1:Number(n.id))}),[E,n.id,w]);return k?(0,c.createElement)("div",{className:f,onClick:C,onKeyDown:e=>"Enter"===e.key||" "===e.key?C():null,role:"treeitem",tabIndex:0},a?(0,c.createElement)(c.Fragment,null,(0,c.createElement)("input",{type:"radio",id:S,name:v,value:n.value,onChange:s(n),onClick:e=>e.stopPropagation(),checked:l,className:"woocommerce-search-list__item-input",...p}),(0,c.createElement)(we,{item:n,search:i}),h?(0,c.createElement)(_e,{label:e||n.count}):null):(0,c.createElement)(c.Fragment,null,(0,c.createElement)(u.CheckboxControl,{className:"woocommerce-search-list__item-input",checked:l,...!l&&n.children.some((e=>m.find((t=>t.id===e.id))))?{indeterminate:!0}:{},label:ge((0,de.decodeEntities)(n.name),i),onChange:()=>{l?s(me(m,n.children,"id"))():s(function(e,t,o){const r=me(t,e,"id");return[...e,...r]}(m,n.children))()},onClick:e=>e.stopPropagation()}),h?(0,c.createElement)(_e,{label:e||n.count}):null)):(0,c.createElement)("label",{htmlFor:S,className:f},a?(0,c.createElement)(c.Fragment,null,(0,c.createElement)("input",{...p,type:"radio",id:S,name:v,value:n.value,onChange:s(n),checked:l,className:"woocommerce-search-list__item-input"}),(0,c.createElement)(we,{item:n,search:i})):(0,c.createElement)(u.CheckboxControl,{...p,id:S,name:v,className:"woocommerce-search-list__item-input",value:(0,de.decodeEntities)(n.value),label:ge((0,de.decodeEntities)(n.name),i),onChange:s(n),checked:l}),h?(0,c.createElement)(_e,{label:e||n.count}):null)},ye=he;var ke=o(5430),Ee=o(906);o(5932);const fe=({id:e,label:t,popoverContents:o,remove:r,screenReaderLabel:n,className:l=""})=>{const[s,i]=(0,c.useState)(!1),m=(0,a.useInstanceId)(fe);if(n=n||t,!t)return null;t=(0,de.decodeEntities)(t);const b=ie()("woocommerce-tag",l,{"has-remove":!!r}),g=`woocommerce-tag__label-${m}`,_=(0,c.createElement)(c.Fragment,null,(0,c.createElement)("span",{className:"screen-reader-text"},n),(0,c.createElement)("span",{"aria-hidden":"true"},t));return(0,c.createElement)("span",{className:b},o?(0,c.createElement)(u.Button,{className:"woocommerce-tag__text",id:g,onClick:()=>i(!0)},_):(0,c.createElement)("span",{className:"woocommerce-tag__text",id:g},_),o&&s&&(0,c.createElement)(u.Popover,{onClose:()=>i(!1)},o),r&&(0,c.createElement)(u.Button,{className:"woocommerce-tag__remove",onClick:r(e),label:(0,d.sprintf)(
// Translators: %s label.
(0,d.__)("Remove %s","woo-gutenberg-products-block"),t),"aria-describedby":g},(0,c.createElement)(p.Z,{icon:Ee.Z,size:20,className:"clear-icon"})))},ve=fe;o(8462);const Se=e=>(0,c.createElement)(ye,{...e}),Ce=e=>{const{list:t,selected:o,renderItem:r,depth:n=0,onSelect:l,instanceId:a,isSingle:s,search:u,useExpandedPanelId:i}=e,[m]=i;return t?(0,c.createElement)(c.Fragment,null,t.map((t=>{var d,p;const b=null!==(d=t.children)&&void 0!==d&&d.length&&!s?t.children.every((({id:e})=>o.find((t=>t.id===e)))):!!o.find((({id:e})=>e===t.id)),g=(null===(p=t.children)||void 0===p?void 0:p.length)&&m===t.id;return(0,c.createElement)(c.Fragment,{key:t.id},(0,c.createElement)("li",null,r({item:t,isSelected:b,onSelect:l,isSingle:s,selected:o,search:u,depth:n,useExpandedPanelId:i,controlId:a})),g?(0,c.createElement)(Ce,{...e,list:t.children,depth:n+1}):null)}))):null},xe=({isLoading:e,isSingle:t,selected:o,messages:r,onChange:n,onRemove:l})=>{if(e||t||!o)return null;const a=o.length;return(0,c.createElement)("div",{className:"woocommerce-search-list__selected"},(0,c.createElement)("div",{className:"woocommerce-search-list__selected-header"},(0,c.createElement)("strong",null,r.selected(a)),a>0?(0,c.createElement)(u.Button,{isLink:!0,isDestructive:!0,onClick:()=>n([]),"aria-label":r.clear},(0,d.__)("Clear all","woo-gutenberg-products-block")):null),a>0?(0,c.createElement)("ul",null,o.map(((e,t)=>(0,c.createElement)("li",{key:t},(0,c.createElement)(ve,{label:e.name,id:e.id,remove:l}))))):null)},Ne=({filteredList:e,search:t,onSelect:o,instanceId:r,useExpandedPanelId:n,...l})=>{const{messages:a,renderItem:s,selected:u,isSingle:i}=l,m=s||Se;return 0===e.length?(0,c.createElement)("div",{className:"woocommerce-search-list__list is-not-found"},(0,c.createElement)("span",{className:"woocommerce-search-list__not-found-icon"},(0,c.createElement)(p.Z,{icon:ke.Z})),(0,c.createElement)("span",{className:"woocommerce-search-list__not-found-text"},t?(0,d.sprintf)(a.noResults,t):a.noItems)):(0,c.createElement)("ul",{className:"woocommerce-search-list__list"},(0,c.createElement)(Ce,{useExpandedPanelId:n,list:e,selected:u,renderItem:m,onSelect:o,instanceId:r,isSingle:i,search:t}))},Ie=e=>{const{className:t="",isCompact:o,isHierarchical:r,isLoading:n,isSingle:l,list:s,messages:i=pe,onChange:m,onSearch:p,selected:b,type:g="text",debouncedSpeak:_}=e,[w,h]=(0,c.useState)(""),y=(0,c.useState)(-1),k=(0,a.useInstanceId)(Ie),E=(0,c.useMemo)((()=>({...pe,...i})),[i]),f=(0,c.useMemo)((()=>((e,t,o)=>{if(!t)return o?be(e):e;const r=new RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"i"),n=e.map((e=>!!r.test(e.name)&&e)).filter(Boolean);return o?be(n,e):n})(s,w,r)),[s,w,r]);(0,c.useEffect)((()=>{_&&_(E.updated)}),[_,E]),(0,c.useEffect)((()=>{"function"==typeof p&&p(w)}),[w,p]);const v=(0,c.useCallback)((e=>()=>{l&&m([]);const t=b.findIndex((({id:t})=>t===e));m([...b.slice(0,t),...b.slice(t+1)])}),[l,b,m]),S=(0,c.useCallback)((e=>()=>{Array.isArray(e)?m(e):-1===b.findIndex((({id:t})=>t===e.id))?m(l?[e]:[...b,e]):v(e.id)()}),[l,v,m,b]),C=(0,c.useCallback)((e=>{const[t]=b.filter((t=>!e.find((e=>t.id===e.id))));v(t.id)()}),[v,b]);return(0,c.createElement)("div",{className:ie()("woocommerce-search-list",t,{"is-compact":o,"is-loading":n,"is-token":"token"===g})},"text"===g&&(0,c.createElement)(xe,{...e,onRemove:v,messages:E}),(0,c.createElement)("div",{className:"woocommerce-search-list__search"},"text"===g?(0,c.createElement)(u.TextControl,{label:E.search,type:"search",value:w,onChange:e=>h(e)}):(0,c.createElement)(u.FormTokenField,{disabled:n,label:E.search,onChange:C,onInputChange:e=>h(e),suggestions:[],__experimentalValidateInput:()=>!1,value:n?[(0,d.__)("Loading…","woo-gutenberg-products-block")]:b.map((e=>({...e,value:e.name}))),__experimentalShowHowTo:!1})),n?(0,c.createElement)("div",{className:"woocommerce-search-list__list"},(0,c.createElement)(u.Spinner,null)):(0,c.createElement)(Ne,{...e,search:w,filteredList:f,messages:E,onSelect:S,instanceId:k,useExpandedPanelId:y}))},Pe=((0,u.withSpokenMessages)(Ie),window.wp.url),Te=window.wp.apiFetch;var Ae,Be=o.n(Te);const Oe=(0,v.getSetting)("wcBlocksConfig",{buildPhase:1,pluginUrl:"",productCount:0,defaultAvatar:"",restApiRoutes:{},wordCountType:"words"}),Le=(Oe.pluginUrl,Oe.pluginUrl,Oe.buildPhase,null===(Ae=v.STORE_PAGES.shop)||void 0===Ae||Ae.permalink,v.STORE_PAGES.checkout.id,v.STORE_PAGES.checkout.permalink,v.STORE_PAGES.privacy.permalink,v.STORE_PAGES.privacy.title,v.STORE_PAGES.terms.permalink,v.STORE_PAGES.terms.title,v.STORE_PAGES.cart.id,v.STORE_PAGES.cart.permalink,v.STORE_PAGES.myaccount.permalink?v.STORE_PAGES.myaccount.permalink:(0,v.getSetting)("wpLoginUrl","/wp-login.php"),(0,v.getSetting)("localPickupEnabled",!1),(0,v.getSetting)("countries",{})),Re=(0,v.getSetting)("countryData",{}),qe=(Object.fromEntries(Object.keys(Re).filter((e=>!0===Re[e].allowBilling)).map((e=>[e,Le[e]||""]))),Object.fromEntries(Object.keys(Re).filter((e=>!0===Re[e].allowBilling)).map((e=>[e,Re[e].states||[]]))),Object.fromEntries(Object.keys(Re).filter((e=>!0===Re[e].allowShipping)).map((e=>[e,Le[e]||""]))),Object.fromEntries(Object.keys(Re).filter((e=>!0===Re[e].allowShipping)).map((e=>[e,Re[e].states||[]]))),Object.fromEntries(Object.keys(Re).map((e=>[e,Re[e].locale||[]]))),(e,t)=>{const o=new Map;return e.filter((e=>{const r=t(e);return!o.has(r)&&(o.set(r,e),!0)}))}),Me=e=>Be()({path:`wc/store/v1/products/attributes/${e}/terms`});const De=window.wp.escapeHtml,Fe=({error:e})=>(0,c.createElement)("div",{className:"wc-block-error-message"},(({message:e,type:t})=>e?"general"===t?(0,c.createElement)("span",null,(0,d.__)("The following error was returned","woo-gutenberg-products-block"),(0,c.createElement)("br",null),(0,c.createElement)("code",null,(0,De.escapeHTML)(e))):"api"===t?(0,c.createElement)("span",null,(0,d.__)("The following error was returned from the API","woo-gutenberg-products-block"),(0,c.createElement)("br",null),(0,c.createElement)("code",null,(0,De.escapeHTML)(e))):e:(0,d.__)("An error has prevented the block from being updated.","woo-gutenberg-products-block"))(e)),je=({className:e,item:t,isSelected:o,isLoading:r,onSelect:n,disabled:l,...a})=>(0,c.createElement)(c.Fragment,null,(0,c.createElement)(he,{...a,key:t.id,className:e,isSelected:o,item:t,onSelect:n,disabled:l}),o&&r&&(0,c.createElement)("div",{key:"loading",className:ie()("woocommerce-search-list__item","woocommerce-product-attributes__item","depth-1","is-loading","is-not-active")},(0,c.createElement)(u.Spinner,null))),$e=((0,v.getSetting)("attributes",[]).reduce(((e,t)=>{const o=(r=t)&&r.attribute_name?{id:parseInt(r.attribute_id,10),name:r.attribute_name,taxonomy:"pa_"+r.attribute_name,label:r.attribute_label}:null;var r;return o&&o.id&&e.push(o),e}),[]),e=>{const{count:t,id:o,name:r,parent:n}=e;return{count:t,id:o,name:r,parent:n,breadcrumbs:[],children:[],value:(c=e,Y(c,"count")&&Y(c,"description")&&Y(c,"id")&&Y(c,"name")&&Y(c,"parent")&&Y(c,"slug")&&"number"==typeof c.count&&"string"==typeof c.description&&"number"==typeof c.id&&"string"==typeof c.name&&"number"==typeof c.parent&&"string"==typeof c.slug?e.attr_slug:"")};var c});o(9669);const Ge=(0,a.withInstanceId)((({onChange:e,onOperatorChange:t,instanceId:o,isCompact:r=!1,messages:n={},operator:l="any",selected:a,type:s="text"})=>{const{errorLoadingAttributes:i,isLoadingAttributes:m,productsAttributes:p}=function(e){const[t,o]=(0,c.useState)(null),[r,n]=(0,c.useState)(!1),[l,a]=(0,c.useState)([]),s=(0,c.useRef)(!1);return(0,c.useEffect)((()=>{if(e&&!r&&!s.current)return async function(){n(!0);try{const e=await Be()({path:"wc/store/v1/products/attributes"}),t=[];for(const o of e){const e=await Me(o.id);t.push({...o,parent:0,terms:e.map((e=>({...e,attr_slug:o.taxonomy,parent:o.id})))})}a(t),s.current=!0}catch(e){e instanceof Error&&o(await(async e=>{if(!("json"in e))return{message:e.message,type:e.type||"general"};try{const t=await e.json();return{message:t.message,type:t.type||"api"}}catch(e){return{message:e.message,type:"general"}}})(e))}finally{n(!1)}}(),()=>{s.current=!0}}),[r,e]),{errorLoadingAttributes:t,isLoadingAttributes:r,productsAttributes:l}}(!0),b=p.reduce(((e,t)=>{const{terms:o,...r}=t;return[...e,$e(r),...o.map($e)]}),[]);return n={clear:(0,d.__)("Clear all product attributes","woo-gutenberg-products-block"),noItems:(0,d.__)("Your store doesn't have any product attributes.","woo-gutenberg-products-block"),search:(0,d.__)("Search for product attributes","woo-gutenberg-products-block"),selected:e=>(0,d.sprintf)(/* translators: %d is the count of attributes selected. */
(0,d._n)("%d attribute selected","%d attributes selected",e,"woo-gutenberg-products-block"),e),updated:(0,d.__)("Product attribute search results updated.","woo-gutenberg-products-block"),...n},i?(0,c.createElement)(Fe,{error:i}):(0,c.createElement)(c.Fragment,null,(0,c.createElement)(Ie,{className:"woocommerce-product-attributes",isCompact:r,isHierarchical:!0,isLoading:m,isSingle:!1,list:b,messages:n,onChange:e,renderItem:e=>{const{item:t,search:r,depth:n=0}=e,l=t.count||0,a=["woocommerce-product-attributes__item","woocommerce-search-list__item",{"is-searching":r.length>0,"is-skip-level":0===n&&0!==t.parent}];if(!t.breadcrumbs.length)return(0,c.createElement)(je,{...e,className:ie()(a),item:t,isLoading:m,disabled:0===t.count,name:`attributes-${o}`,countLabel:(0,d.sprintf)(/* translators: %d is the count of terms. */
(0,d._n)("%d term","%d terms",l,"woo-gutenberg-products-block"),l),"aria-label":(0,d.sprintf)(/* translators: %1$s is the item name, %2$d is the count of terms for the item. */
(0,d._n)("%1$s, has %2$d term","%1$s, has %2$d terms",l,"woo-gutenberg-products-block"),t.name,l)});const s=`${t.breadcrumbs[0]}: ${t.name}`;return(0,c.createElement)(he,{...e,name:`terms-${o}`,className:ie()(...a,"has-count"),countLabel:(0,d.sprintf)(/* translators: %d is the count of products. */
(0,d._n)("%d product","%d products",l,"woo-gutenberg-products-block"),l),"aria-label":(0,d.sprintf)(/* translators: %1$s is the attribute name, %2$d is the count of products for that attribute. */
(0,d._n)("%1$s, has %2$d product","%1$s, has %2$d products",l,"woo-gutenberg-products-block"),s,l)})},selected:a.map((({id:e})=>b.find((t=>t.id===e)))).filter(Boolean),type:s}),!!t&&(0,c.createElement)("div",{hidden:a.length<2},(0,c.createElement)(u.SelectControl,{className:"woocommerce-product-attributes__operator",label:(0,d.__)("Display products matching","woo-gutenberg-products-block"),help:(0,d.__)("Pick at least two attributes to use this setting.","woo-gutenberg-products-block"),value:l,onChange:t,options:[{label:(0,d.__)("Any selected attributes","woo-gutenberg-products-block"),value:"any"},{label:(0,d.__)("All selected attributes","woo-gutenberg-products-block"),value:"all"}]})))})),Ve=`${v.ADMIN_URL}edit.php?post_type=product&page=product_attributes`,He=({query:e,setQueryAttribute:t})=>{const o=e.woocommerceAttributes||[],r=null==o?void 0:o.map((({termId:e})=>({id:e})));return(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Product Attributes","woo-gutenberg-products-block"),hasValue:()=>!(null==o||!o.length)},(0,c.createElement)(Ge,{messages:{search:(0,d.__)("Attributes","woo-gutenberg-products-block")},selected:r||[],onChange:e=>{const o=e.map((({id:e,value:t})=>({termId:e,taxonomy:t})));t({woocommerceAttributes:o})},operator:"any",isCompact:!0,type:"token"}),(0,c.createElement)(u.ExternalLink,{className:"wc-block-editor-product-collection-panel__manage-attributes-link",href:Ve},(0,d.__)("Manage attributes","woo-gutenberg-products-block")))},Ze=window.wp.coreData,Qe=[],ze={order:"asc",_fields:"id,name,slug",context:"view"},Je=(e,t)=>(null==e?void 0:e.id)||t.get(e)||t.get(e.toLocaleLowerCase()),Ke=(e,t,o)=>1===o.get(e)?e:`${e} - ${t}`,Ue=({taxonomy:e,termIds:t,onChange:o})=>{const[r,n]=(0,c.useState)(void 0),l=(0,c.useRef)(Qe),s=(0,c.useRef)(Qe),i=(0,a.useDebounce)(n,250),{termIdToNameMap:m,termNameToIdMap:d,isResolving:p}=(e=>{const{records:t,isResolving:o}=(0,Ze.useEntityRecords)("taxonomy",e.slug,{...ze});return(0,c.useMemo)((()=>{const e=new Map,r=new Map;if(!t)return{termIdToNameMap:e,termNameToIdMap:r,isResolving:o};const n=(e=>e.reduce(((e,t)=>{const o=t.name;return e.has(o)?e.set(o,e.get(o)+1):e.set(o,1),e}),new Map))(t);for(const o of t){const t=o.id,c=o.name,l=Ke(c,o.slug,n);e.set(t,l),r.set(l,t),r.set(l.toLocaleLowerCase(),t)}return{termIdToNameMap:e,termNameToIdMap:r,isResolving:o}}),[t,o])})(e),{records:b,hasResolved:g}=(0,Ze.useEntityRecords)("taxonomy",e.slug,{...ze,search:r,orderby:"name",exclude:t,per_page:20},{enabled:void 0!==r});l.current=(0,c.useMemo)((()=>g?b.map((e=>m.get(e.id)||e.name)):l.current),[g,b,m]);const{records:_,hasResolved:w}=(0,Ze.useEntityRecords)("taxonomy",e.slug,{...ze,include:t},{enabled:(null==t?void 0:t.length)>0});return s.current=(0,c.useMemo)((()=>!1===w?s.current:_&&t.length?_.map((({id:e,name:t})=>({id:e,value:m.get(e)||t}))):Qe),[_,w,m,t]),(0,c.createElement)("div",{className:"wc-block-editor-product-collection-inspector__taxonomy-control"},(0,c.createElement)(u.FormTokenField,{label:e.name,value:s.current,onInputChange:i,suggestions:l.current,onChange:e=>{const t=[];for(const o of e){const e=Je(o,d);e&&t.push(e)}o(t)},disabled:p,__experimentalShowHowTo:!1}))},We=function({setQueryAttribute:e,query:t}){const{taxQuery:o}=t,r=(0,f.useSelect)((e=>{const{getTaxonomies:t}=e(Ze.store);return t({type:"product",per_page:-1,context:"view"})}),[]);return r&&0!==r.length?(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Taxonomies","woo-gutenberg-products-block"),hasValue:()=>Object.values(o||{}).some((e=>!!e.length)),onDeselect:()=>e({taxQuery:{}})},r.map((t=>{const r=(null==o?void 0:o[t.slug])||[];return(0,c.createElement)(Ue,{key:t.slug,taxonomy:t,termIds:r,onChange:r=>e({taxQuery:{...o,[t.slug]:r}})})}))):null},Ye=({query:e,setQueryAttribute:t})=>{const o=e.woocommerceHandPickedProducts,{productsMap:r,productsList:n}=function(){const[e,t]=(0,c.useState)(new Map),[o,r]=(0,c.useState)([]);return(0,c.useEffect)((()=>{(({selected:e=[],search:t="",queryArgs:o={}})=>{const r=(({selected:e=[],search:t="",queryArgs:o={}})=>{const r=Oe.productCount>100,n={per_page:r?100:0,catalog_visibility:"any",search:t,orderby:"title",order:"asc"},c=[(0,Pe.addQueryArgs)("/wc/store/v1/products",{...n,...o})];return r&&e.length&&c.push((0,Pe.addQueryArgs)("/wc/store/v1/products",{catalog_visibility:"any",include:e,per_page:0})),c})({selected:e,search:t,queryArgs:o});return Promise.all(r.map((e=>Be()({path:e})))).then((e=>{const t=e.flat(),o=qe(t,(e=>e.id));return o.map((e=>({...e,parent:0})))})).catch((e=>{throw e}))})({selected:[]}).then((e=>{const o=new Map;e.forEach((e=>{o.set(e.id,e),o.set(e.name,e)})),r(e),t(o)}))}),[]),{productsMap:e,productsList:o}}(),l=(0,c.useCallback)((e=>{const o=e.reduce(((e,t)=>{const o=r.get(t)||r.get(Number(t));return o&&e.add(String(o.id)),e}),new Set);t({woocommerceHandPickedProducts:Array.from(o)})}),[t,r]),a=(0,c.useMemo)((()=>n.filter((e=>!(null!=o&&o.includes(String(e.id))))).map((e=>e.name))),[n,o]);return(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Hand-picked Products","woo-gutenberg-products-block"),hasValue:()=>!(null==o||!o.length),onDeselect:()=>{t({woocommerceHandPickedProducts:[]})}},(0,c.createElement)(u.FormTokenField,{disabled:!r.size,displayTransform:e=>{const t=Number(e);if(Number.isNaN(t))return e;const o=r.get(t);return(null==o?void 0:o.name)||""},label:(0,d.__)("Pick some products","woo-gutenberg-products-block"),onChange:l,suggestions:a,__experimentalValidateInput:e=>r.has(e),value:r.size?o||[]:[(0,d.__)("Loading…","woo-gutenberg-products-block")],__experimentalExpandOnFocus:!0}))},Xe={who:"authors",per_page:-1,_fields:"id,name",context:"view"},et=function({query:e,setQueryAttribute:t}){const o=e.author,{records:r,error:n}=(0,Ze.useEntityRecords)("root","user",Xe);if(n)return(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Authors","woo-gutenberg-products-block"),hasValue:()=>!0},(0,c.createElement)(u.FormTokenField,{label:(0,d.__)("Authors","woo-gutenberg-products-block"),value:[(0,d.__)("Error occurred while loading authors.","woo-gutenberg-products-block")],disabled:!0}));if(!r)return null;const l=(e=>{const t=new Map,o=new Map,r=[];return e.forEach((e=>{t.set(Number(e.id),e),o.set(e.name,e),r.push(e.name)})),{authors:e,mapById:t,mapByName:o,names:r}})(r),a=o?o.split(",").map((e=>{const t=l.mapById.get(Number(e));return t?{id:t.id,value:t.name}:null})).filter(Boolean):[];return(0,c.createElement)(u.__experimentalToolsPanelItem,{hasValue:()=>!!o,label:(0,d.__)("Authors","woo-gutenberg-products-block"),onDeselect:()=>t({author:""})},(0,c.createElement)(u.FormTokenField,{label:(0,d.__)("Authors","woo-gutenberg-products-block"),value:a,suggestions:l.names,onChange:e=>{const o=Array.from(e.reduce(((e,t)=>{const o=((e,t)=>{var o;const r=(null==t?void 0:t.id)||(null===(o=e.get(t))||void 0===o?void 0:o.id);if(r)return r})(l.mapByName,t);return o&&e.add(o),e}),new Set));t({author:o.join(",")})}}))},tt=e=>{switch(e){case D.GRID:return(0,d.__)("Display products using rows and columns.","woo-gutenberg-products-block");case D.STACK:return(0,d.__)("Display products in a single column.","woo-gutenberg-products-block");default:return""}},ot=D.GRID,rt=e=>{const{type:t,columns:o}=e.displayLayout,r=t=>{e.setAttributes({displayLayout:{type:t,columns:o}})};return(0,c.createElement)(u.__experimentalToolsPanelItem,{label:(0,d.__)("Layout","woo-gutenberg-products-block"),hasValue:()=>t!==ot,isShownByDefault:!0,onDeselect:()=>{r(D.GRID)}},(0,c.createElement)(u.__experimentalToggleGroupControl,{label:(0,d.__)("Layout","woo-gutenberg-products-block"),isBlock:!0,onChange:e=>{r(e)},help:tt(t),value:t},(0,c.createElement)(u.__experimentalToggleGroupControlOption,{value:D.STACK,label:(0,d.__)("Stack","woo-gutenberg-products-block")}),(0,c.createElement)(u.__experimentalToggleGroupControlOption,{value:D.GRID,label:(0,d.__)("Grid","woo-gutenberg-products-block")})))},nt=e=>{const t=e.attributes.query,o=!1===(null==t?void 0:t.inherit),r=(0,c.useMemo)((()=>q.bind(null,e)),[e]),n={setAttributes:e.setAttributes,displayLayout:e.attributes.displayLayout},a={setQueryAttribute:r,query:t};return(0,c.createElement)(l.InspectorControls,null,(0,c.createElement)(u.__experimentalToolsPanel,{label:(0,d.__)("Settings","woo-gutenberg-products-block"),resetAll:()=>{const t=(o=e.attributes,{displayLayout:Z(),query:H(o.query)});var o;e.setAttributes(t)}},(0,c.createElement)(rt,{...n}),(0,c.createElement)(U,{...n}),(0,c.createElement)(ee,{...a}),o?(0,c.createElement)(oe,{...a}):null),o?(0,c.createElement)(u.__experimentalToolsPanel,{label:(0,d.__)("Filters","woo-gutenberg-products-block"),resetAll:t=>{q(e,Q),t.forEach((e=>e()))},className:"wc-block-editor-product-collection-inspector-toolspanel__filters"},(0,c.createElement)(re,{...a}),(0,c.createElement)(ae,{...a}),(0,c.createElement)(Ye,{...a}),(0,c.createElement)(se,{...a}),(0,c.createElement)(He,{...a}),(0,c.createElement)(We,{...a}),(0,c.createElement)(et,{...a})):null,(0,c.createElement)(E,null))};(()=>{if((0,v.isWpVersion)("6.1",">=")){const{status:e}=P()}})();const ct=e=>{const t=e+2592e5;return Date.now()<t},lt=(e=0)=>e<=4;(0,w.addFilter)("editor.BlockEdit","woocommerce/product-collection",(e=>t=>{if(!(e=>e===n.name)(t.name))return(0,c.createElement)(e,{...t});const o=(e=>{const{attributes:t}=e,{convertedFromProducts:o}=t,{status:r,time:n,displayCount:c}=P();return o&&"notseen"===r&&ct(n)&&lt(c)})(t),r=(e=>{const{attributes:t}=e,{convertedFromProducts:o}=t,{status:r,time:n,displayCount:c}=P();return o&&("seen"===r||!ct(n)||!lt(c))})(t);return r&&t.setAttributes({convertedFromProducts:!1}),(0,c.createElement)(c.Fragment,null,o&&(0,c.createElement)(l.InspectorControls,null,(0,c.createElement)(K,{revertMigration:R})),(0,c.createElement)(e,{...t}))})),o(6547);var at=o(9522);const st=({onToggle:e})=>(0,c.createElement)(u.ToolbarButton,{icon:at.Z,label:(0,d.__)("Display settings","woo-gutenberg-products-block"),onClick:e}),ut=({query:e,setQueryAttribute:t})=>{const o=e=>{const o=Number(e);!isNaN(o)&&o>=1&&o<=100&&t({perPage:o})},r=e=>{const o=Number(e);!isNaN(o)&&o>=0&&o<=100&&t({offset:o})},n=e=>{const o=Number(e);!isNaN(o)&&o>=0&&t({pages:o})},l={__unstableInputWidth:"60px",labelPosition:"edge",step:"1",isDragEnabled:!1};return(0,c.createElement)(u.ToolbarGroup,null,(0,c.createElement)(u.Dropdown,{contentClassName:"wc-block-editor-product-collection__display-settings",renderToggle:({onToggle:e})=>(0,c.createElement)(st,{onToggle:e}),renderContent:()=>(0,c.createElement)(c.Fragment,null,(0,c.createElement)(u.__experimentalNumberControl,{...l,label:(0,d.__)("Items per Page","woo-gutenberg-products-block"),min:1,max:100,onChange:o,value:e.perPage}),(0,c.createElement)(u.__experimentalNumberControl,{...l,label:(0,d.__)("Offset","woo-gutenberg-products-block"),min:0,max:100,onChange:r,value:e.offset}),(0,c.createElement)(u.BaseControl,{help:(0,d.__)("Limit the pages you want to show, even if the query has more results. To show all pages use 0 (zero).","woo-gutenberg-products-block"),id:"woocommerce-products-block__display-settings-pages"},(0,c.createElement)(u.__experimentalNumberControl,{...l,label:(0,d.__)("Max page to show","woo-gutenberg-products-block"),min:0,onChange:n,value:e.pages})))}))};var it=o(8960),mt=o(5186);const dt=e=>{const{type:t,columns:o}=e.displayLayout,r=t=>{e.setAttributes({displayLayout:t})},n=[{icon:it.Z,title:(0,d.__)("List view","woo-gutenberg-products-block"),onClick:()=>r({type:"list",columns:o}),isActive:"list"===t},{icon:mt.Z,title:(0,d.__)("Grid view","woo-gutenberg-products-block"),onClick:()=>r({type:"flex",columns:o}),isActive:"flex"===t}];return(0,c.createElement)(u.ToolbarGroup,{controls:n})},pt=e=>(0,c.createElement)(u.ToolbarGroup,null,(0,c.createElement)(u.ToolbarButton,{onClick:e.openPatternSelectionModal},(0,d.__)("Choose pattern","woo-gutenberg-products-block"))),bt="woocommerce/product-collection",gt=e=>{const{clientId:t,query:o}=e,{replaceBlock:n,selectBlock:a}=(0,f.useDispatch)(l.store),s=e=>{const t=e.innerBlocks.map(s);if(e.name===bt){const{perPage:n,offset:c,pages:l}=e.attributes.query,a={...o,perPage:n,offset:c,pages:l};return(0,r.cloneBlock)(e,{query:a},t)}return(0,r.cloneBlock)(e,{},t)},i=(0,f.useSelect)((e=>{const{getBlockRootClientId:o,getPatternsByBlockTypes:r}=e(l.store),n=o(t);return r(bt,n)}),[bt,t]);return(0,c.createElement)(u.Modal,{overlayClassName:"wc-blocks-product-collection__selection-modal",title:(0,d.__)("Choose a pattern","woo-gutenberg-products-block"),onRequestClose:e.closePatternSelectionModal,isFullScreen:!0},(0,c.createElement)("div",{className:"wc-blocks-product-collection__selection-content"},(0,c.createElement)(l.__experimentalBlockPatternsList,{blockPatterns:i,shownPatterns:i,onClickPattern:(e,o)=>{const r=o.map(s);n(t,r),a(r[0].clientId)}})))};function _t(e){const[t,o]=(0,c.useState)(!1),{attributes:r,clientId:n,setAttributes:a}=e,{query:s,displayLayout:u}=r,i=(0,c.useMemo)((()=>q.bind(null,e)),[e]);return(0,c.createElement)(l.BlockControls,null,(0,c.createElement)(pt,{openPatternSelectionModal:()=>o(!0)}),!s.inherit&&(0,c.createElement)(c.Fragment,null,(0,c.createElement)(ut,{query:s,setQueryAttribute:i}),(0,c.createElement)(dt,{displayLayout:u,setAttributes:a})),t&&(0,c.createElement)(gt,{clientId:n,query:s,closePatternSelectionModal:()=>o(!1)}))}const wt=[["woocommerce/product-template",{},[["woocommerce/product-image",{imageSizing:s.THUMBNAIL}],["core/post-title",{textAlign:"center",level:3,fontSize:"medium",style:{spacing:{margin:{bottom:"0.75rem",top:"0"}}},isLink:!0,__woocommerceNamespace:_}],["woocommerce/product-price",{textAlign:"center",fontSize:"small"}],["woocommerce/product-button",{textAlign:"center",fontSize:"small"}]]],["core/query-pagination",{layout:{type:"flex",justifyContent:"center"}}],["core/query-no-results"]],ht=e=>{var t;const{attributes:o,setAttributes:r}=e,{queryId:n}=o,s=(0,l.useBlockProps)(),u=(0,l.useInnerBlocksProps)(s,{template:wt}),i=(0,a.useInstanceId)(ht);return(0,c.useEffect)((()=>{Number.isFinite(n)||r({queryId:Number(i)})}),[n,i,r]),(0,c.useEffect)((()=>{r({...V,query:{...V.query,inherit:M()},...o})}),[r]),"boolean"!=typeof(null==o||null===(t=o.query)||void 0===t?void 0:t.inherit)?null:(0,c.createElement)("div",{...s},(0,c.createElement)(nt,{...e}),(0,c.createElement)(_t,{...e}),(0,c.createElement)("div",{...u}))},yt=ht;var kt=o(897);const Et=(0,d.__)("Product Summary","woo-gutenberg-products-block"),ft=((0,c.createElement)(p.Z,{icon:kt.Z,className:"wc-block-editor-components-block-icon"}),(0,d.__)("Display a short description about a product.","woo-gutenberg-products-block"));(0,r.registerBlockType)(n,{icon:()=>(0,c.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,c.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19 11H5C4.72386 11 4.5 11.2239 4.5 11.5V17.5C4.5 17.7761 4.72386 18 5 18H19C19.2761 18 19.5 17.7761 19.5 17.5V11.5C19.5 11.2239 19.2761 11 19 11ZM5 9.5H19C20.1046 9.5 21 10.3954 21 11.5V17.5C21 18.6046 20.1046 19.5 19 19.5H5C3.89543 19.5 3 18.6046 3 17.5V11.5C3 10.3954 3.89543 9.5 5 9.5Z",fill:"currentColor"}),(0,c.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 7.5C18 7.77614 17.7761 8 17.5 8L6.5 8C6.22386 8 6 7.77614 6 7.5V7.5C6 7.22386 6.22386 7 6.5 7L17.5 7C17.7761 7 18 7.22386 18 7.5V7.5Z",fill:"currentColor"}),(0,c.createElement)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 5C16 5.27614 15.7761 5.5 15.5 5.5L8.5 5.5C8.22386 5.5 8 5.27614 8 5V5C8 4.72386 8.22386 4.5 8.5 4.5L15.5 4.5C15.7761 4.5 16 4.72386 16 5V5Z",fill:"currentColor"})),edit:yt,save:function({attributes:{tagName:e="div"}}){const t=l.useBlockProps.save(),o=l.useInnerBlocksProps.save(t);return(0,c.createElement)(e,{...o})}}),m("core/post-excerpt",{blockDescription:ft,blockIcon:(0,c.createElement)(u.Icon,{icon:kt.Z}),blockTitle:Et,variationName:"woocommerce/product-collection/product-summary"}),m("core/post-title",{blockDescription:g,blockIcon:(0,c.createElement)(u.Icon,{icon:i.Z}),blockTitle:b,variationName:_})},6547:()=>{},4662:()=>{},9669:()=>{},8462:()=>{},5932:()=>{},4333:e=>{"use strict";e.exports=window.wp.compose},9307:e=>{"use strict";e.exports=window.wp.element},5736:e=>{"use strict";e.exports=window.wp.i18n},444:e=>{"use strict";e.exports=window.wp.primitives}},o={};function r(e){var n=o[e];if(void 0!==n)return n.exports;var c=o[e]={exports:{}};return t[e].call(c.exports,c,c.exports,r),c.exports}r.m=t,e=[],r.O=(t,o,n,c)=>{if(!o){var l=1/0;for(i=0;i<e.length;i++){for(var[o,n,c]=e[i],a=!0,s=0;s<o.length;s++)(!1&c||l>=c)&&Object.keys(r.O).every((e=>r.O[e](o[s])))?o.splice(s--,1):(a=!1,c<l&&(l=c));if(a){e.splice(i--,1);var u=n();void 0!==u&&(t=u)}}return t}c=c||0;for(var i=e.length;i>0&&e[i-1][2]>c;i--)e[i]=e[i-1];e[i]=[o,n,c]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=4603,(()=>{var e={4603:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var n,c,[l,a,s]=o,u=0;if(l.some((t=>0!==e[t]))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(s)var i=s(r)}for(t&&t(o);u<l.length;u++)c=l[u],r.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return r.O(i)},o=self.webpackChunkwebpackWcBlocksJsonp=self.webpackChunkwebpackWcBlocksJsonp||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var n=r.O(void 0,[2869],(()=>r(3415)));n=r.O(n),((this.wc=this.wc||{}).blocks=this.wc.blocks||{})["product-collection"]=n})();